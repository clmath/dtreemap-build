require.config({"config":{"delite/css":{"layersMap":{"dtreemap/themes/DrillDownUp.css":"dtreemap/css/layer.css","dtreemap/themes/GroupLabel.css":"dtreemap/css/layer.css","dtreemap/themes/TreeMap.css":"dtreemap/css/layer.css"}}}});
define("dtreemap/DrillDownUp",["dcl/dcl","dojo/dom-geometry","dojo/_base/fx","delite/css!./themes/DrillDownUp.css","dpointer/events"],function(a,b,c){return a(null,{postCreate:function(){this.on("dblclick",this._dblClickHandler.bind(this))},_dblClickHandler:function(a){var b=this._getRendererFromTarget(a.target);if(b.item){var c=b.item;if(this._isLeaf(c)&&(c=b.parentItem,b=this.itemToRenderer[this.getIdentity(c)],null==b))return;this.rootItem===c?this.drillUp(b):this.drillDown(b),a.preventDefault(),a.stopPropagation()}},drillUp:function(a){var d=a.item,e=this,f=a.parentNode;f.removeChild(a),this.rootItem=this._getRenderer(d).parentItem,this.deliver(),this.containerNode.appendChild(a),a.style.zIndex=40;var g=b.position(this._getRenderer(d),!0),h=b.getMarginBox(this);c.animateProperty({node:a,duration:500,properties:{left:{end:g.x-h.l},top:{end:g.y-h.t},height:{end:g.h},width:{end:g.w}},onAnimate:function(){var c=b.getContentBox(a);e._layoutGroupContent(a,c.w,c.h,a.level+1,!1,!0)},onEnd:function(){f.removeChild(a)}}).play()},drillDown:function(a){var d=b.getMarginBox(this),e=a.item,f=this,g=a.parentNode;g.removeChild(a),this.containerNode.appendChild(a);var h=a.style.zIndex;a.style.zIndex=40,c.animateProperty({node:a,duration:500,properties:{left:{end:0},top:{end:0},height:{end:d.h},width:{end:d.w}},onAnimate:function(){var c=b.getContentBox(a);f._layoutGroupContent(a,c.w,c.h,a.level+1,!1)},onEnd:function(){a.style.zIndex=h,f.rootItem=e}}).play()}})}),define("dtreemap/GroupLabel",["dcl/dcl","delite/css!./themes/GroupLabel.css"],function(a){return a(null,{createRenderer:a.superCall(function(b){return function(c,d,e){var f=b.call(this,c,d,e);if("content"===e||"leaf"===e){var g=this.ownerDocument.createElement("div");a.mix(g.style,{zIndex:30,position:"relative",height:"100%",textAlign:"center",top:"50%",marginTop:"-.5em"}),f.appendChild(g)}return f}}),styleRenderer:function(a,b,c,d){switch(d){case"leaf":a.style.background=this.getColorForItem(b).toHex();case"content":a.firstChild.innerHTML=0===c?this.getLabelForItem(b):null;break;case"header":a.style.display="none"}}})}),define("dtreemap/Keyboard",["dcl/dcl","delite/keys","./_utils","delite/focus","dpointer/events"],function(a,b,c){return a(null,{constructor:function(){},postCreate:function(){this.on("keydown",this._keyDownHandler.bind(this)),this.on("pointerdown",this._pointerDownHandler.bind(this)),this.hasAttribute("tabindex")||(this.tabIndex="0"),this.on("focusin",this._focusInHandler.bind(this))},createRenderer:a.superCall(function(a){return function(b,c,d){var e=a.call(this,b,c,d);return e.setAttribute("tabindex","-1"),e}}),_focusInHandler:function(){this.selectedItem||(this.selectedItem=this.firstChild.firstChild.item)},_pointerDownHandler:function(){this.focus()},_keyDownHandler:function(a){var d=this.selectedItem;if(d){var e,f,g,h=this.itemToRenderer[this.getIdentity(d)],i=h.parentItem;if(a.keyCode!==b.UP_ARROW&&a.keyCode!==b.NUMPAD_MINUS&&a.keyCode!==b.NUMPAD_PLUS){if(e=a.keyCode===b.DOWN_ARROW?d.children:i.children,!e)return;f=c.initElements(e,this._computeAreaForItem.bind(this)).elements,g=f[e.indexOf(d)],f.sort(function(a,b){return b.size-a.size})}this._navigate(a,h,d,i,e,f,g)}},_navigate:function(a,c,d,e,f,g,h){var i;switch(a.keyCode){case b.LEFT_ARROW:i=f[g[Math.max(0,g.indexOf(h)-1)].index];break;case b.RIGHT_ARROW:i=f[g[Math.min(g.length-1,g.indexOf(h)+1)].index];break;case b.DOWN_ARROW:i=f[g[0].index];break;case b.UP_ARROW:i=e;break;case b.NUMPAD_PLUS:!this._isLeaf(d)&&this.drillDown&&(this.drillDown(c),a.preventDefault(),a.stopPropagation());break;case b.NUMPAD_MINUS:!this._isLeaf(d)&&this.drillUp&&(this.drillUp(c),a.preventDefault(),a.stopPropagation())}i&&this._selectItem(a,i)},_selectItem:function(a,b){this._isRoot(b)||(this.selectedItem=b,a.preventDefault(),a.stopPropagation())}})}),define("dtreemap/ScaledLabel",["dcl/dcl","dojo/dom-geometry"],function(a,b){var c=function(a){if("leaf"===a.kind){var c=a.renderer,d=c.ownerDocument.defaultView.getComputedStyle(c,null).fontSize;c.firstChild.style.fontSize=d,d=parseInt(d,10);for(var e=.75*b.getContentBox(c).w/b.getMarginBox(c.firstChild).w,f=b.getContentBox(c).h/b.getMarginBox(c.firstChild).h,g=b.getContentBox(c).w-b.getMarginBox(c.firstChild).w,h=b.getContentBox(c).h-b.getMarginBox(c.firstChild).h,i=Math.floor(d*Math.min(e,f));h>0&&g>0;)c.firstChild.style.fontSize=i+"px",g=b.getContentBox(c).w-b.getMarginBox(c.firstChild).w,h=b.getContentBox(c).h-b.getMarginBox(c.firstChild).h,d=i,i+=1;(0>h||0>g)&&(c.firstChild.style.fontSize=d+"px")}};return a(null,{preCreate:function(){this.on("treemap-renderer-updated",c)},createRenderer:a.superCall(function(b){return function(c,d,e){var f=b.call(this,c,d,e);if("leaf"===e){var g=this.ownerDocument.createElement("div");a.mix(g.style,{position:"absolute",width:"auto"}),f.appendChild(g)}return f}}),styleRenderer:a.superCall(function(a){return function(b,c,d,e){"leaf"!==e?a.call(this,b,c,d,e):(b.style.background=this.getColorForItem(c).toHex(),b.firstChild.innerHTML=this.getLabelForItem(c))}})})}),define("dtreemap/TreeMap",["dcl/dcl","delite/register","dcolor/Color","dojo/when","dojo/dom-geometry","dojo/dom-class","./_utils","dpointer/events","delite/Widget","delite/Selection","delite/StoreMap","delite/css!./themes/TreeMap.css","delite/uacss"],function(a,b,c,d,e,f,g,h,i,j,k){return b("d-treemap",[HTMLElement,i,j,k],{baseClass:"d-treemap",itemToRenderer:null,rootItem:null,tooltipAttr:"",tooltipFunc:null,areaAttr:"",areaFunc:null,labelAttr:"label",labelFunc:null,labelThreshold:0/0,colorAttr:"",colorFunc:null,colorModel:null,groupAttrs:[],groupFuncs:null,_groupFuncs:null,mapAtInit:!1,copyAllItemProps:!0,preCreate:function(){this.allowRemap=!0,this.itemToRenderer={}},getIdentity:function(a){return a.__treeID?a.__treeID:this.store.getIdentity(a)},resize:function(a){a&&(e.setMarginBox(this,a),this.invalidateRendering())},postCreate:function(){this.on("pointerover",this._pointerOverHandler.bind(this)),this.on("pointerout",this._pointerOutHandler.bind(this)),this.on("pointerup",this._pointerUpHandler.bind(this)),this.setAttribute("role","presentation"),this.setAttribute("aria-label","treemap")},computeProperties:function(a){this.renderItems&&this._mappedKeys.some(function(b){return a.hasOwnProperty(b+"Attr")||a.hasOwnProperty(b+"Func")})&&this.remap(),("renderItems"in a||"groupAttrs"in a||"groupFuncs"in a)&&(this._set("rootItem",null),this.notifyCurrentValue("rootItem")),"renderItems"in a&&(this.notifyCurrentValue("groupAttrs"),this.notifyCurrentValue("colorAttr"))},refreshRendering:function(b){var c=!1;("groupAttrs"in b||"groupFuncs"in b)&&(this._updateTreeMapHierarchy(),c=!0),("colorAttr"in b||"colorFunc"in b||"colorModel"in b)&&(c=!0,null!=this.colorModel&&null!=this.renderItems&&this.colorModel.initialize&&this.colorModel.initialize(this.renderItems,this._colorFunc.bind(this))),("areaAttr"in b||"areaFunc"in b)&&(this._removeAreaForGroup(),c=!0),("rootItem"in b||c)&&this._groupeditems&&(null==this.containerNode&&(this.containerNode=this.ownerDocument.createElement("div"),a.mix(this.containerNode.style,{position:"relative",width:"100%",height:"100%"}),this.appendChild(this.containerNode)),"rootItem"in b?(this.containerNode.innerHTML="",this._render(!0)):this._render(!1))},_render:function(a){var b,c=this.rootItem;if(null!=c){var d=this._getRenderer(c);d&&(this._isLeaf(c)&&(c=d.parentItem),b=d.parentItem)}var f=e.getMarginBox(this);null==c||this._isRoot(c)?this._buildChildrenRenderers(this.containerNode,c?c:{__treeRoot:!0,children:this._groupeditems},0,a,null):this._buildRenderer(this.containerNode,b,c,{x:0,y:0,w:f.w,h:f.h},0,a)},_setGroupAttrsAttr:function(a){null==this.groupFuncs&&(this._groupFuncs=null!=a?a.map(function(a){return function(b){return b[a]}}):null),this._set("groupAttrs",a)},_setGroupFuncsAttr:function(a){this._set("groupFuncs",this._groupFuncs=a),null==a&&null!=this.groupAttrs&&(this._groupFuncs=this.groupAttrs.map(function(a){return function(b){return b[a]}}))},_colorFunc:function(a){if(this.colorFunc)return this.colorFunc(a);var b=a.color;return b||(b=0),parseFloat(b)},createRenderer:function(b,c,d){var e=this.ownerDocument.createElement("div");return"header"!==d&&a.mix(e.style,{overflow:"hidden",position:"absolute"}),e},styleRenderer:function(a,b,c,d){switch(d){case"leaf":a.style.background=this.getColorForItem(b).toHex();case"header":var e=this.getLabelForItem(b);a.innerHTML=e&&(isNaN(this.labelThreshold)||c<this.labelThreshold)?e:""}},_updateTreeMapHierarchy:function(){var a=this.renderItems;null!=a&&(this._groupeditems=null!=this._groupFuncs&&this._groupFuncs.length>0?g.group(a,this._groupFuncs,this._getAreaForItem.bind(this)).children:a)},_removeAreaForGroup:function(a){var b;if(null!=a){if(!a.__treeValue)return;delete a.__treeValue,b=a.children}else b=this._groupeditems;if(b)for(var c=0;c<b.length;++c)this._removeAreaForGroup(b[c])},_getAreaForItem:function(a){var b=parseFloat(a.area);return isNaN(b)?0:b},_computeAreaForItem:function(a){var b;if(a.__treeID){if(b=a.__treeValue,!b){b=0;for(var c=a.children,d=0;d<c.length;++d)b+=this._computeAreaForItem(c[d]);a.__treeValue=b}}else b=this._getAreaForItem(a);return b},getColorForItem:function(a){var b=this._colorFunc(a);return null!=this.colorModel?this.colorModel.getColor(b):new c(b)},getLabelForItem:function(a){return a.__treeName?a.__treeName:a.label.toString()},_buildChildrenRenderers:function(a,b,c,d,f,h){var i=b.children,j=e.getMarginBox(a),k=g.solve(i,j.w,j.h,this._computeAreaForItem.bind(this),!this.isLeftToRight()),l=k.rectangles;f&&(l=l.map(function(a){return a.x+=f.l,a.y+=f.t,a}));for(var m,n=0;n<i.length;++n)m=l[n],this._buildRenderer(a,b,i[n],m,c,d,h)},_isLeaf:function(a){return!a.children},_isRoot:function(a){return a.__treeRoot},_getRenderer:function(a,b,c){if(b)for(var d=0;d<c.children.length;++d)if(c.children[d].item===a)return c.children[d];return this.itemToRenderer[this.getIdentity(a)]},_buildRenderer:function(a,b,c,d,f,g,h){var i=this._isLeaf(c),j=g?null:this._getRenderer(c,h,a);j=i?this._updateLeafRenderer(j,c,f):this._updateGroupRenderer(j,c,f),g&&(j.level=f,j.item=c,j.parentItem=b,this.itemToRenderer[this.getIdentity(c)]=j,this.updateRenderers(c));var k=Math.floor(d.x),l=Math.floor(d.y),m=Math.floor(d.x+d.w+1e-11)-k,n=Math.floor(d.y+d.h+1e-11)-l;if(g&&a.appendChild(j),e.setMarginBox(j,{l:k,t:l,w:m,h:n}),!i){var o=e.getContentBox(j);this._layoutGroupContent(j,o.w,o.h,f+1,g,h)}this.emit("treemap-renderer-updated",{renderer:j,item:c,kind:i?"leaf":"group",level:f})},_layoutGroupContent:function(a,b,c,d,f,g){var h=a.querySelector(".d-treemap-header"),i=a.querySelector(".d-treemap-groupcontent");if(null!=h&&null!=i){var j=e.getMarginBox(h);j.h>c?(j.h=c,i.style.display="none"):(i.style.dispaly="block",e.setMarginBox(i,{l:0,t:j.h,w:b,h:c-j.h}),this._buildChildrenRenderers(i,a.item,d,f,null,g)),e.setMarginBox(h,{l:0,t:0,w:b,h:j.h})}},_updateGroupRenderer:function(a,b,c){var d=null==a;null==a&&(a=this.createRenderer("div",c,"group"),f.add(a,"d-treemap-group")),this.styleRenderer(a,b,c,"group");var e=a.querySelector(".d-treemap-header");e=this._updateHeaderRenderer(e,b,c),d&&a.appendChild(e);var g=a.querySelector(".d-treemap-groupcontent");return g=this._updateGroupContentRenderer(g,b,c),d&&a.appendChild(g),a},_updateHeaderRenderer:function(a,b,c){return null==a&&(a=this.createRenderer(b,c,"header"),f.add(a,"d-treemap-header"),f.add(a,"d-treemap-header_"+c)),this.styleRenderer(a,b,c,"header"),a},_updateLeafRenderer:function(a,b,c){return null==a&&(a=this.createRenderer(b,c,"leaf"),f.add(a,"d-treemap-leaf"),f.add(a,"d-treemap-leaf_"+c)),this.styleRenderer(a,b,c,"leaf"),b.tooltip&&(a.title=b.tooltip),a},_updateGroupContentRenderer:function(a,b,c){return null==a&&(a=this.createRenderer(b,c,"content"),f.add(a,"d-treemap-groupcontent"),f.add(a,"d-treemap-groupcontent_"+c)),this.styleRenderer(a,b,c,"content"),a},_getRendererFromTarget:function(a){for(var b=a;b!==this&&!b.item;)b=b.parentNode;return b},_pointerOverHandler:function(a){var b=this._getRendererFromTarget(a.target);if(b.item){var c=b.item;this.updateRenderers(c),this.emit("treemap-item-over",{renderer:b,item:c,triggerEvent:a})}},_pointerOutHandler:function(a){var b=this._getRendererFromTarget(a.target);if(b.item){var c=b.item;this.updateRenderers(c),this.emit("treemap-item-out",{renderer:b,item:c,triggerEvent:a})}},_pointerUpHandler:function(a){var b=this._getRendererFromTarget(a.target);b.item&&this.selectFromEvent(a,b.item,b,!0)},updateRenderers:function(a){if(a){Array.isArray(a)||(a=[a]);for(var b=0;b<a.length;b++){var c=a[b],d=this._getRenderer(c);if(d){var e=this.isSelected(c);e?f.add(d,"d-selected"):f.remove(d,"d-selected")}}}}})}),define("dtreemap/_utils",[],function(){var a={group:function(b,c,d){var e={children:[]},f=function(a,b){return a.__treeValue||(a.__treeValue=0),a.__treeValue+=d(b),a};return b.forEach(function(b){var d=e;c.forEach(function(e,g){var h=e(b),i=a.find(d.children,function(a){return a.__treeName===h});i||d.children.push(i={__treeName:h,__treeID:h+Math.random(),children:[]}),i=f(i,b),g!==c.length-1?d=i:i.children.push(b)}),d=f(d,b)}),e},find:function(a,b){for(var c=a.length,d=0;c>d;++d)if(b.call(null,a[d]))return a[d];return null},solve:function(b,c,d,e,f){var g=a.initElements(b,e),h=g.total,i=g.elements,j=h;if(0===h){if(0===i.length)return{items:b,rects:[],total:0};i.forEach(function(a){a.size=a.sizeTmp=100}),h=100*i.length}i.sort(function(a,b){return b.size-a.size}),a._compute(c,d,i,h),i.sort(function(a,b){return a.index-b.index});var k={};return k.elements=i,k.size=j,k.rectangles=i.map(function(a){return{x:f?c-a.x-a.width:a.x,y:a.y,w:a.width,h:a.height}}),k},initElements:function(a,b){var c=0,d=a.map(function(a,d){var e=null!=b?b(a):0;if(0>e)throw new Error("item size dimension must be positive");return c+=e,{index:d,size:e,sizeTmp:e}});return{elements:d,total:c}},_compute:function(b,c,d,e){var f=b*c/e/100;d.forEach(function(a){a.sizeTmp*=f});for(var g,h,i=0,j=0,k=-1>>>1,l=0,m=0,n=b,o=c,p=n>o;j!==d.length;)if(g=a._trySolution(d,i,j,p,n,o),g>k||1>g){var q=0,r=0;for(h=i;j>h;h++)d[h].x=l+q,d[h].y=m+r,p?r+=d[h].height:q+=d[h].width;p?l+=d[i].width:m+=d[i].height,n=b-l,o=c-m,p=n>o,i=j,j=i,k=-1>>>1}else{for(h=i;j>=h;h++)d[h].width=d[h].widthTmp,d[h].height=d[h].heightTmp;k=g,j++}var s=0,t=0;for(h=i;j>h;h++)d[h].x=l+s,d[h].y=m+t,p?t+=d[h].height:s+=d[h].width},_trySolution:function(a,b,c,d,e,f){var g,h,i=0,j=0,k=0;for(h=b;c>=h;h++)i+=a[h].sizeTmp;for(d?0===f?j=k=0:(j=i/f*100,k=f):0===e?j=k=0:(k=i/e*100,j=e),h=b;c>=h;h++)d?(a[h].widthTmp=j,a[h].heightTmp=0===i?0:k*a[h].sizeTmp/i):(a[h].widthTmp=0===i?0:j*a[h].sizeTmp/i,a[h].heightTmp=k);return g=Math.max(a[c].heightTmp/a[c].widthTmp,a[c].widthTmp/a[c].heightTmp),void 0===g?1:g}};return a});
//# sourceMappingURL=layer.map